# 智能文档解析系统使用说明

## 系统概述

智能文档解析系统是一个能够自动识别和解析各种格式题目文档的工具，支持Word、Excel、PDF、TXT等多种格式，能够自动提取题目序号、内容、选项、答案、解析和图片等信息。

## 主要功能

### 1. 多格式支持
- **Word文档** (.docx, .doc) - 支持包含图片的文档
- **Excel表格** (.xlsx, .xls) - 支持表格格式
- **PDF文档** (.pdf) - 支持PDF格式
- **文本文档** (.txt) - 支持纯文本格式

### 2. 智能识别功能
- **题目序号识别**：自动识别 1.、1、第1题、(1)、1) 等格式
- **选项识别**：自动识别 A.、A、等选项格式
- **答案识别**：自动识别 答案：A、正确答案：A 等格式
- **解析识别**：自动识别 解析：、解答：、说明：、分析： 等格式
- **图片提取**：自动提取文档中的图片并关联到题目
- **题目类型判断**：自动判断单选题、多选题、判断题

### 3. 两种上传模式

#### 智能解析模式
- 支持复杂格式的文档
- 自动识别题目结构
- 支持图片提取
- 适合格式不统一的文档

#### 手动导入模式
- 需要标准表格结构
- 支持Excel和CSV格式
- 适合批量导入标准化数据

## 使用方法

### 1. 访问智能上传页面
在管理系统中点击"智能上传"菜单，进入智能题目上传页面。

### 2. 选择题库和科目
- 选择题库：从下拉列表中选择目标题库
- 选择科目：选择题库下的具体科目

### 3. 选择上传模式
- **智能解析**：适合复杂格式文档
- **手动导入**：适合标准表格格式

### 4. 上传文件
- 拖拽文件到上传区域，或点击选择文件
- 支持的文件大小限制：50MB
- 智能模式支持：Word、Excel、PDF、TXT
- 手动模式支持：Excel、CSV

### 5. 预览解析结果（智能模式）
- 点击"预览解析"按钮
- 查看解析出的题目列表
- 检查题目内容、选项、答案、解析是否正确
- 查看有效题目和无效题目的统计

### 6. 确认导入
- 检查预览结果无误后，点击"确认导入"
- 系统会将有效题目保存到数据库
- 显示导入成功的题目数量

## 题目格式要求

### Word/TXT格式示例
```
1. 以下哪个选项是正确的？
A. 选项A的内容
B. 选项B的内容
C. 选项C的内容
D. 选项D的内容
答案：A
解析：这是解析内容

2. 第二道题目...
A. 选项A
B. 选项B
答案：B
解析：解析内容
```

### Excel格式要求
| 题目内容 | 选项A | 选项B | 选项C | 选项D | 答案 | 解析 |
|---------|-------|-------|-------|-------|------|------|
| 以下哪个选项是正确的？ | 选项A的内容 | 选项B的内容 | 选项C的内容 | 选项D的内容 | A | 这是解析内容 |

## 技术特性

### 1. 智能识别算法
- 使用正则表达式匹配题目结构
- 支持多种题目序号格式
- 自动判断题目类型
- 容错处理机制

### 2. 图片处理
- 自动提取Word文档中的图片
- 图片压缩和格式转换
- 图片与题目的关联存储

### 3. 数据验证
- 题目完整性检查
- 选项数量验证
- 答案格式验证
- 无效题目标记

### 4. 错误处理
- 文件格式验证
- 文件大小限制
- 解析错误提示
- 部分成功处理

## 注意事项

1. **文件格式**：确保上传的文件格式正确，文件大小不超过50MB
2. **题目结构**：智能模式需要题目有清晰的结构，建议使用标准格式
3. **图片处理**：Word文档中的图片会被自动提取，请确保图片清晰
4. **数据备份**：建议在导入前备份现有数据
5. **权限要求**：只有管理员用户才能使用智能上传功能

## 故障排除

### 常见问题

1. **解析失败**
   - 检查文件格式是否正确
   - 确认题目结构是否符合要求
   - 查看错误提示信息

2. **图片无法显示**
   - 确认Word文档中图片格式正确
   - 检查图片文件是否损坏

3. **题目识别错误**
   - 调整题目格式，使用标准格式
   - 检查题目序号和选项格式

4. **导入失败**
   - 检查网络连接
   - 确认数据库连接正常
   - 查看服务器日志

## 更新日志

### v1.0.0 (2024-01-XX)
- 初始版本发布
- 支持Word、Excel、PDF、TXT格式
- 智能题目识别功能
- 图片提取和处理
- 双模式上传支持

## 技术支持

如有问题或建议，请联系技术支持团队。
